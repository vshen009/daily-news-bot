# 图片分享功能 - 需求文档

**项目**: Daily News Bot
**功能**: 单条新闻卡片生成精美图片，支持长按保存分享
**文档版本**: v3.0 Final
**创建时间**: 2025-02-09
**状态**: ✅ 需求已确认，可以交付开发

---

## 📋 目录

1. [功能概述](#功能概述)
2. [已确认的需求](#已确认的需求)
3. [设计风格规范](#设计风格规范)
4. [图片布局结构](#图片布局结构)
5. [用户交互流程](#用户交互流程)
6. [测试页面规格](#测试页面规格)
7. [需求确认总结](#需求确认总结)

---

## 功能概述

将单条新闻卡片生成为精美的竖版图片，用户点击"图片"按钮后，前端直接生成图片并弹出预览，用户可长按保存并分享到微信等社交媒体。

**核心价值**:
- ✅ 社交媒体友好：精美设计，适合分享
- ✅ 操作简单：一键生成，长按保存
- ✅ 品牌传播：自动带二维码和品牌信息

---

## 已确认的需求

### 1. 生成内容
- ✅ **单条新闻完整版**：包含标题、摘要、来源、时间
- ❌ **不包含**：AI锐评（不在图片中显示）
- ❌ **不包含**：英文原标题（不在图片中显示）
- ✅ 不生成整日报告，只生成单条新闻

### 2. 设计风格
- ✅ **纯粹社论风**：报纸质感、紧凑布局、高对比度
- ✅ **杂志风格**：像精美的报纸单条新闻摘要卡
- ✅ **无科技感装饰**：去掉渐变背景和几何图形

### 3. 二维码位置
- ✅ 位于新闻卡片最下方，右对齐
- ✅ 大小：150×150px
- ✅ 左侧文字："Shared by 文森特"（一行显示）
- ✅ 整体视觉协调，作为新闻卡片的页尾
- ✅ 字体颜色：浅灰色 `#94A3B8`
- ✅ 二维码样式：带爱马仕橙点缀（现代）

### 4. 二维码链接
- ✅ 链接到当天的新闻页面（如 `2025-02-08.html`）

### 5. 图片尺寸
- ✅ 宽度：1080px（固定）
- ✅ 高度：自适应（根据内容自动调整）
- ✅ 适合iPhone在微信聊天框里阅读

### 6. 用户流程
- ✅ 点击"图片"按钮
- ✅ 直接弹出生成好的图片（居中预览，有关闭按钮）
- ✅ 用户自己长按图片，调用手机原生功能保存或分享

### 7. 测试页面
- ✅ 放在新的子文件夹（不要上传到GitHub）
- ✅ 包含2-3条测试新闻

### 8. 图片格式
- ✅ JPG/JPEG（文件小，加载快）
- ❌ 不使用PNG（文件太大）

### 9. 实现方式
- ✅ 前端HTML直接生成（使用 html2canvas）
- ✅ 不需要后端处理

---

## 设计风格规范

### 一、核心设计原则

#### 1. 风格定位
**Compact Editorial（纯粹紧凑社论风）**

- **设计理念**: 像精美的报纸单条新闻摘要卡或杂志新闻侧边栏卡片
- **核心特点**: 信息聚焦、高对比、视觉冲击力
- **无科技装饰**: 去掉渐变背景、几何图形、科技线条
- **纯粹质感**: 报纸米色背景、报纸排版、高对比度文字

#### 2. 布局逻辑
- 严格的网格系统
- 拒绝无效留白
- 围绕单条新闻核心要素进行高密度聚合
- 突出信息层级

### 二、色彩方案

#### 主色调（纯粹社论风）
```css
/* 背景色系 */
--bg-primary: #e5e0d8;        /* 沉稳的报纸米色（整个图片背景） */
--bg-secondary: #ece8e1;      /* 浅色背景块（导语区） */
--bg-card: #ffffff;           /* 白色卡片（核心要素区） */

/* 文字色系 */
--text-primary: #2c241b;      /* 近乎黑的深褐（高对比主文字） */
--text-secondary: #64748B;    /* 深灰（次要文字） */
--text-tertiary: #94A3B8;     /* 浅灰（页尾Shared by） */

/* 强调色系 */
--accent: #c17c4a;            /* 爱马仕橙/暖棕（来源/时间、图标） */

/* 装饰色系 */
--border-color: #dcd6ce;      /* 分割线颜色 */
--border-thick: #2c241b;      /* 粗黑线（Header分割线） */
```

**重要说明**:
- ❌ 去掉了蓝紫渐变
- ❌ 去掉了几何装饰
- ✅ 纯粹的报纸米色背景
- ❌ 图片始终使用亮色主题（不考虑暗色模式）
- ✅ 原因：微信聊天框多为白色背景，亮色图片显示效果更好

### 三、字体系统

#### 字体引入
```html
<!-- 字体引入 -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@700;900&family=Noto+Sans+SC:wght@500;700&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
<!-- 图标库 -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
```

#### 字体用途
| 用途 | 字体 | 字重 | 行高 | 用途说明 |
|------|------|------|------|---------|
| **超大标题** | 'Noto Serif SC' | 900 | 0.85 | 极其紧凑的衬线大标题，报纸质感 |
| **来源/时间** | 'Oswald' | 700 | - | 高窄的无衬线体，现代感强 |
| **正文** | 'Noto Sans SC' | 500/700 | 1.6 | 清晰易读的中文 |
| **核心要素** | 'Noto Sans SC' | 500/700 | - | 标签700，说明500 |

---

## 图片布局结构

### 一、整体规格

#### 基础规格（✅ 已确认）
- **尺寸**: 宽度1080px固定，高度自适应（根据内容自动调整）
- **格式**: JPG/JPEG（文件小，加载快）
- **圆角**: 16px
- **背景**: `#e5e0d8`（报纸米色，整个图片背景）
- **图片质量**: 0.85（平衡清晰度和文件大小）
- **二维码样式**: 带爱马仕橙点缀（现代）
- **二维码大小**: 150×150px
- **品牌Logo**: 不显示

### 二、布局结构（从上到下）- 纯粹社论风

```
┌──────────────────────────────────────┐
│ 📰 新闻卡片 (整个图片就是卡片)       │
│                                       │
│ 整体尺寸: 1080px宽 × 自适应高度       │
│ 背景: #e5e0d8 (报纸米色)              │
│ 圆角: 16px                           │
│ 内边距: 60px                         │
│                                       │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                       │
│ Header (新闻报头)                     │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                       │
│ 📰 [超大标题]                         │
│ 字体: Noto Serif SC                   │
│ 字重: 900                             │
│ 大小: 64px (4rem)                     │
│ 颜色: #2c241b                         │
│ 行高: 0.85 (极其紧凑)                 │
│ 最多2行，超出显示"..."                │
│                                       │
│ 来源: BLOOMBERG | 2小时前             │
│ 字体: Oswald                          │
│ 字重: 700                             │
│ 大小: 18px                            │
│ 颜色: #c17c4a (爱马仕橙)              │
│ 全大写                                │
│                                       │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│ 粗黑线 border-b-4 border-[#2c241b]   │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                       │
│ News Lead (新闻导语区)                │
│ ┃📦                                   │
│ 背景: #ece8e1 (浅米色)                │
│ 左边框: 4px #c17c4a (橙色粗边框)     │
│ 内边距: 32px                          │
│ 外边距: 上下32px                      │
│                                       │
│ [摘要内容]                            │
│ 字体: Noto Sans SC                    │
│ 字重: 500                             │
│ 大小: 28px                            │
│ 颜色: #2c241b                         │
│ 行高: 1.6                             │
│ 最多6行，超出显示"..."                │
│                                       │
│ News Core Elements (核心要素区)       │
│ ┃📊 (可选，如果有关键数据)            │
│                                       │
│ [白色卡片]                            │
│ 背景: #ffffff                         │
│ 边框: 1px solid #dcd6ce               │
│ 圆角: 8px                             │
│ 内边距: 20px                          │
│                                       │
│ 图标 + 要素标签 + 极简说明             │
│ (最多3个核心要素)                      │
│                                       │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│ 分割线 border-t-2 border-[#dcd6ce]   │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                       │
│        Shared by 文森特  [📷二维码]   │ ← 一行，右对齐
│                                       │
└──────────────────────────────────────┘
```

### 三、详细布局说明

#### 1. 整体卡片（整个图片）
- **尺寸**: 宽度1080px固定，高度自适应（根据内容自动调整）
- **背景**: `#e5e0d8`（报纸米色，整个图片就是卡片）
- **圆角**: 16px
- **内边距**: 60px
- **无阴影**: 纯平面设计
- **品牌Logo**: 不显示

#### 2. Header（新闻报头）

**超大标题**:
- 字体: `'Noto Serif SC'`, 900
- 大小: 64px (4rem)
- 行高: 0.85（极其紧凑）
- 颜色: `#2c241b`
- 最多2行，超出显示"..."
- 紧贴顶部
- 底部有粗黑线分割: `border-b-4 border-[#2c241b]`

**来源/时间**:
- 字体: `'Oswald'`, 700
- 大小: 18px
- 颜色: `#c17c4a`（爱马仕橙）
- 格式: `来源: [SOURCE] | [TIME]`
- 全大写英文 + 中文组合
- 位置: 标题下方，粗黑线上方

#### 3. News Lead（新闻导语区）
- **背景**: `#ece8e1`（浅米色）
- **左边框**: `border-l-4 border-[#c17c4a]`（4px橙色）
- **内边距**: 32px
- **外边距**: 上下32px
- **字体**: `'Noto Sans SC'`, 500
- **大小**: 28px
- **颜色**: `#2c241b`
- **行高**: 1.6
- **最多6行**，超出显示"..."

#### 4. News Core Elements (新闻核心要素区) - 可选

**用途**: 展示新闻的关键数据、地点、人物等核心要素（最多3个）

**卡片设计**:
- **背景**: `#ffffff`（纯白）
- **边框**: `1px solid #dcd6ce`（细微边框）
- **圆角**: 8px
- **内边距**: 20px
- **外边距**: 顶部24px

**内容格式**（水平排列或垂直列表）:
```
┌─────────────────────────────┐
│ 📊 [要素标签] [极简说明]    │
│ 💰 [要素标签] [极简说明]    │
│ 📍 [要素标签] [极简说明]    │
└─────────────────────────────┘
```

- **图标**: Font Awesome 图标（`<i class="fa-solid fa-chart-line"></i>`）
- **标签**: `'Noto Sans SC'`, 700, 20px, `#c17c4a`
- **说明**: `'Noto Sans SC'`, 500, 18px, `#2c241b`
- **数量**: 不超过3个核心要素

**示例**:
```
📊 涨幅 +2.3%   💰 金额 1万亿   📍 地点 上海
```

#### 5. 页尾
- **分割线**: `border-t-2 border-[#dcd6ce]`
- **文字**:
  - 字体: `'Noto Sans SC'`, 500
  - 大小: 20px
  - 颜色: `#94A3B8`（浅灰）
  - 内容: `Shared by 文森特`（✅ 已确认）
  - 对齐: 右对齐
  - 布局: 与二维码在同一行
- **二维码**:
  - 尺寸: 150×150px（✅ 已确认）
  - 位置: 右下角，与文字同行
  - 样式: 带爱马仕橙点缀（✅ 已确认）
  - 链接: 当天的新闻页面（如 `2025-02-08.html`）

---

## 用户交互流程

### 一、正常流程

```
1. 用户点击"图片"按钮
   ↓
2. 按钮变为loading状态
   - 图标变为加载动画
   - 文字变为"生成中..."
   - 按钮禁用，防止重复点击
   ↓
3. Toast显示
   - 内容: "正在生成图片，请稍候..."
   - 位置: 屏幕底部
   - 持续时间: 直到生成完成
   ↓
4. 后台处理（3-5秒）
   - 创建隐藏DOM容器
   - 填充新闻内容
   - 渲染为图片
   ↓
5. 弹出居中图片预览（✅ 已确认居中样式）
   - 图片居中显示（不是全屏）
   - 背景遮罩: 半透明黑色 `rgba(0,0,0,0.8)`
   - 顶部提示条: "长按图片保存到相册"
   - 底部关闭按钮: "关闭"
   ↓
6. 用户操作
   - 长按图片 → 调用手机原生保存/分享功能
   - 点击关闭按钮 → 关闭预览
   - 点击遮罩区域 → 关闭预览
   ↓
7. 关闭预览
   - 删除临时DOM容器
   - 按钮恢复原状
   - Toast消失
```

### 二、错误处理

#### 1. 生成失败
**Toast提示**: "图片生成失败，请尝试长按截图分享"
**降级方案**: 引导用户手动截图

#### 2. 超时
**Toast提示**: "生成超时，请稍后重试"
**可能原因**:
- 网络问题（字体加载慢）
- 内容过长（渲染时间久）
- 浏览器兼容性问题

#### 3. 不支持
**Toast提示**: "您的浏览器不支持图片生成，请截图分享"
**检测方法**:
```javascript
if (!window.html2canvas) {
  showToast('您的浏览器不支持图片生成');
}
```

#### 4. 内容过长
**处理方案**:
- 标题最多2行
- 摘要最多6行
- 超出部分显示"..."

---

## 测试页面规格

### 一、文件位置

#### 目录结构
```
daily-news-bot/
├── share-test/              # 新建子文件夹（不上传GitHub）
│   └── test-share.html     # 测试页面
├── .gitignore              # 添加 /share-test/
```

#### .gitignore 配置
```gitignore
# 测试文件夹（不上传）
/share-test/
```

### 二、测试数据

#### 新闻1：短标题+短摘要
```json
{
  "title": "美联储维持利率不变",
  "content": "美联储FOMC会议决定将基准利率维持在5.25%-5.5%区间，符合市场预期。点阵图显示年内仍有降息空间。",
  "source": "Bloomberg",
  "publish_time": "2025-02-09T10:00:00",
  "url": "https://example.com/news/1"
}
```

#### 新闻2：长标题+长摘要
```json
{
  "title": "中国央行宣布下调存款准备金率0.5个百分点释放长期资金约1万亿元人民币支持实体经济发展",
  "content": "中国人民银行宣布决定下调金融机构存款准备金率0.5个百分点（不含已执行5%存款准备金率的金融机构）。本次下调后，大型金融机构存款准备金率为8.5%，中小金融机构为6.5%。此次降准释放长期资金约1万亿元，旨在保持银行体系流动性合理充裕，支持实体经济发展。",
  "source": "新华社",
  "publish_time": "2025-02-09T07:00:00",
  "url": "https://example.com/news/2"
}
```

#### 新闻3：英文新闻+翻译
```json
{
  "title": "日元跌至160关口",
  "content": "受美联储降息预期与日本央行政策分歧影响，日元汇率跌至160关口，创34年新低。市场预期日本央行可能干预汇市。",
  "source": "Reuters",
  "publish_time": "2025-02-09T11:00:00",
  "url": "https://example.com/news/3"
}
```

---

## 需求确认总结

所有需求已确认完成，可以交付开发：

| 编号 | 问题 | 确认结果 |
|------|------|---------|
| **1** | **图片尺寸** | ✅ 宽度1080px固定，高度自适应 |
| **2** | **原标题显示** | ✅ 不显示 |
| **3** | **页尾域名** | ✅ "Shared by 文森特"（不显示域名） |
| **4** | **二维码样式** | ✅ 带爱马仕橙点缀（现代） |
| **5** | **二维码大小** | ✅ 150×150px |
| **6** | **弹窗样式** | ✅ 居中（有关闭按钮） |
| **7** | **背景装饰** | ✅ 无装饰（纯粹报纸质感） |
| **8** | **卡片边框** | ✅ 无边框，纯平面 |
| **9** | **品牌Logo** | ✅ 不显示 |
| **10** | **图片格式** | ✅ JPG/JPEG |

---

## 重要说明

### ❌ 不要做的事情

- ❌ 不要在图片中显示 AI 锐评
- ❌ 不要在图片中显示英文原标题
- ❌ 不要使用 PNG 格式（文件太大）
- ❌ 不要显示品牌 Logo
- ❌ 不要使用渐变背景
- ❌ 不要添加几何装饰

### ✅ 必须做的事情

- ✅ 必须使用报纸米色背景 `#e5e0d8`
- ✅ 必须使用 Noto Serif SC 900 作为标题字体
- ✅ 必须显示"Shared by 文森特"
- ✅ 必须使用 JPG/JPEG 格式
- ✅ 必须使用带爱马仕橙点缀的二维码
- ✅ 二维码必须是 150×150px

---

## 联系方式

- **项目负责人**: Vincent
- **需求规划**: Claude
- **代码开发**: Code X

---

**文档版本**: v3.0 Final
**最后更新**: 2025-02-09
